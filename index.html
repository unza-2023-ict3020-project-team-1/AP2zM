<!DOCTYPE html>
<html>
	<head>
		<!-- application title-->
		<title>AP2zM</title>
		<link href="style.css" rel="stylesheet" type="text/css">
		<!-- script to create multiple linear file entries in form-->
		<script>
		
			let counter = 0;
			
			function addFiles (){
				var pdfI = document.getElementById("pdfI"+counter);
				var metaI = document.getElementById("metaI"+counter);
				var p1 = pdfI.files[0];
				var m1 = metaI.files[0];
				
				if ( pdfI.files.length > 0  && metaI.files.length > 0){
					document.getElementById("apiForm").style.display = "none";
					var list = document.getElementById("list");
					const br = document.createElement("br");

					const pdfIn = pdfI.files;
					var p = pdfIn[0];
					const metaIn = metaI.files;
					var m = metaIn[0];

									
					const tableCont = document.getElementById("files-list");
					var table = document.createElement("table");
					var newRow = table.insertRow(-1);
					var cell1 = newRow.insertCell(0);
					var cell2 = newRow.insertCell(1);
					cell1.className = "file-cell";
					cell2.className = "file-cell";
					cell1.style.width = "50%";
					cell2.style.width = "60%";
					cell2.style.paddingLeft = "10%";
					cell1.innerHTML = p.name;
					cell2.innerHTML = m.name;
					table.style.width = "92%";
					document.getElementById("choser").textContent = "Selecting Files";
					table.style.tableLayout = "fixed";
					tableCont.appendChild(table);
					tableCont.appendChild(document.createElement("hr"));



					const parent = document.getElementById("inputForm");
		
					var pdfOld = document.getElementById("pdfL");
					pdfOld.setAttribute("for", "pdfI"+(counter + 1)); 
					pdfOld = document.getElementById("pdfI"+counter);
					var pdfNew = pdfOld.cloneNode(true);
					pdfNew.id = "pdfI"+(counter + 1);
					pdfNew.value = "";
					parent.insertBefore(pdfNew, pdfOld.nextSibling);

					var metaOld = document.getElementById("metaL");
					metaOld.setAttribute("for", "metaI"+(counter + 1)); 
					metaOld = document.getElementById("metaI"+counter);
					var metaNew = metaOld.cloneNode(true);
					metaNew.id = "metaI"+(counter + 1);
					metaNew.value = "";
					
					parent.insertBefore(metaNew, metaOld.nextSibling);
					counter++;
				} else {
					alert("please select files for both inputs to continue")
				}
			}
			
			function refresh(){
				location.reload(); 
			};
		</script>

	</head>
	
	<body>
		<p id="ap2zm">AP2zM</p>
		<div style="text-align: right">
			<button type="button" id="refresh" style="text-align: center" onclick="refresh()">refresh</button>
			<br><br><br>
		</div>
		<div style="text-align: right">
			<a href="help.html"><button type="button" id="help" style="text-align: center">help</button></a>
			<br><br><br>
		</div>

		<div id="apiForm" style="text-align:center">
			<br><br><br>
			<h2 class="choice">Use API</h2>
			<!-- This form allows users to enter API-->
			<form  onsubmit="fetchPDF(); return false;" method="post" action="api_form_process.php" class="container">
				<!-- This input field allows users to enter the API URL, and it is required. -->
				<div style="display:inline-block; width: 45%" class="urlInputParent">
					<label style="font-size:120%; color: black;">Documents Url<label><br>
					<input type="text" class="apiURL" name="documnentUrl" placeholder="Enter Documents API URL" required>
				</div>
				<div style="display:inline-block; width: 50%;" class="urlInputParent">
					<label style="font-size:120%; color: black;">Metadata Url<label><br>
					<input type="text" class="apiURL" name="metadataUrl" style="margin-left:4%" placeholder="Enter Metadata API URL" required>
				</div>
				<br><br><br>
				<!-- This image input acts as a a button with specific dimensions and a border -->
				<input type="submit" value="fetch">
				<br><br><br>
			</form>
			<br><br><br><br><br><br><br><br>
		</div>
		
		<!-- upload header 1 tag title -->
		<h2 id="choser" class="choice"> Upload files</h2>
		<div style="text-align: center" class="container">
			<!-- div to create listing table using javascript-->
			<div id="files-list">
			</div><br>
			<!-- This form allows users to upload files and will be submitted to "upload.php" -->
			<form action="file_upload.php" method="post" enctype="multipart/form-data" style="text-align: center;" id="inputForm">
				<label for="pdfI0" id="pdfL"><img  src="pdf.png" width="8%" alt="upload pdf"></label>
				<input type="file" name="pdfFile[]" id="pdfI0" style="display: none;" multiple id="pdfArr0" >
				<label for="metaI0" id="metaL"><img src="meta.png" width="10%" alt="upload metadata"></label>	
				<input type="file" name="metaFile[]" id="metaI0" style="display: none;" multiple id="metaArr0" >
				<br><br>
				<button type="button" id="addmore" onclick="addFiles()"><!--<img src="add-files.png" alt="add files">-->Add Files</button>
				<br><br>
				<button type="submit">Upload</button>
				<br><br>
			</form>
		</div>
	</body>
</html>
